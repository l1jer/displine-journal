## `操作系统的运行环境`

### `操作系统的运行机制`
__内核(Kernal)__: 是操作系统最核心的部分, 由很多内核程序组成操作系统内核  

__应用程序__ -> 非特权指令 //加减法指令  
__内核程序__ -> 特权指令  

__内核态__ -> 内核程序运行中, 可执行特权指令  
__用户态__ -> 应用程序运行中, 只可以执行非特性指令  
CPU 中有一个寄存器叫`程序状态字寄存器(PSW)`
* 1:内核态/核心态/管态;
* 0:用户态/目态.  

__内核态 -> 用户态__: 执行一条特权指令进而修改PSW标志位为用户态,意味着OS将主动让出CPU使用权.  
__用户态 -> 内核态__: 由"中断"引发, 硬件自动完成变态过程, 触发`中断信号`(此信号每次出现意味着操作系统需要介入)意味着操作系统将强行夺回 CPU 的使用权.  

### 中断与异常
#### __中断的作用__: CPU 上会运行操作 `系统内核程序` 和 `应用程序` 两种; 是唯一能让操作系统内核夺回 CPU 使用权的途径, 如若没有它, 那么 CPU 会一直运行应用程序.

#### __中断的类型__: 
* 内中断(异常/例外): 与当前执行指令有关, 中断信号来源于 CPU 内部;
  * `陷入指令`:应用程序主动交还 CPU 控制权给操作系统内核, `系统调用`就是通过`陷入指令`来完成的.
  * 陷阱/陷入 trap; 故障 fault; 终止 abort.
* 外中断(中断): 与当前执行指令无关, 中断信号来源于 CPU 外部.
  * 时钟中断: 由时钟部件发来中断信号(每隔一段时间会给 CPU 发送一个中断信号).
  * I/O 中断请求: 由输入/输出设备发来的中断信号, 由 CPU 处理 I/O 中断的内核程序来执行.

#### __中断机制的基本原理__
* 不同的中断信号, 需要用不同的中断处理程序来处理